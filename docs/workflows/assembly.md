# assembly.mk

The `assembly.mk` workflow contains rules for performing _de novo_ and reference-based sequence assembly.

:::{note} TODO
Rules for reference-based assembly is in progress.
:::

## assemble

Run a _de novo_ assembly pipeline using `spades` and `megahit`. Each tool is designated a directory under `assembly` to store all output.

**{sc}`Parameters`**

- READ_DIR: path to directory storing reads
- ASSEMBLER: specified tool for running the assembly (default: none)
- MIN_CONTIG_LEN: minimum contig length for screening contigs (default: 200)
- THREADS: number of cores (default: 8)
- PE: treat reads as pair-end (default: true)

**{sc}`Example Usage`**
Assemble trimmed reads into contigs using `megahit`
```bash
make -f src/assembly.mk assemble READ_DIR=fastp/reads ASSEMBLER=megahit
```

Assemble trimmed reads into contigs using `spades`
```bash
make -f src/assembly.mk assemble READ_DIR=fastp/reads ASSEMBLER=spades
```

Generate contigs for all supported assemblers:
```bash
make -f src/assembly.mk assemble READ_DIR=fastp/reads
```

## evaluate

Calculate assembly statistics to evaluate and compare assemblies.

This rule searches all directories under `assembly` to find the FASTA files containing the assembled contigs. Reports are stored in the default output directory of `quast` (quast_results).

**{sc}`Parameters`**

- ASSEMBLER: specified tool for running the assembly (default: none)

**{sc}`Example Usage`**
Run `quast` on assembly generated by `megahit`.
```bash
make -f src/assembly.mk evaluate ASSEMBLER=megahit
```

Run `quast` on assembly generated by `spades`.
```bash
make -f src/assembly.mk evaluate ASSEMBLER=spades
```

Run `quast` on all assemblies located in the `assembly` directory.
```bash
make -f src/assembly.mk evaluate
```

## visualize

Generate an image of the genome graph generated from the assembly using `bandage`.

Produces images are saved in the `assembly/bandage` subdirectory.

**{sc}`Parameters`**

- ASSEMBLER: specified tool for running the assembly (default: none)

**{sc}`Example Usage`**
Visualize contigs generated by `megahit`.
```bash
make -f src/assembly.mk visualize ASSEMBLER=spades
```

Visualize contigs generated by `spades`.
```bash
make -f src/assembly.mk visualize ASSEMBLER=spades
```

Visualize contigs from all assemblies.
```bash
make -f src/assembly.mk visualize
```
